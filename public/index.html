<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>๐ฝ๏ธ ุทูุจุงุช ุงูุทุนุงู - ููุฑูุชุงููุง</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: {
                            DEFAULT: '#3b82f6',
                            '50': '#eff6ff',
                            '100': '#dbeafe',
                            '200': '#bfdbfe',
                            '300': '#93c5fd',
                            '400': '#60a5fa',
                            '500': '#3b82f6',
                            '600': '#2563eb',
                            '700': '#1d4ed8',
                            '800': '#1e40af',
                            '900': '#1e3a8a',
                        },
                        secondary: '#10b981',
                        accent: '#f59e0b',
                        danger: '#ef4444',
                        warning: '#f59e0b',
                        dark: '#111827',
                        light: '#f9fafb'
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                        arabic: ['Inter', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="bg-light text-dark">
    <!-- Header -->
    <header class="header-compact sticky top-0 z-40 bg-white">
        <div class="max-w-md mx-auto px-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center gap-3">
                    <div class="w-8 h-8 bg-secondary rounded-lg flex items-center justify-center">
                        <span class="text-sm">๐ฝ๏ธ</span>
                    </div>
                    <div>
                        <h1 class="font-bold text-base text-gray-900">ุทูุจุงุช ุงูุทุนุงู</h1>
                        <p class="text-xs text-gray-500">ููุฑูุชุงููุง</p>
                    </div>
                </div>

                <div class="relative">
                    <button id="cartBtn" class="relative p-2">
                        <span class="text-lg">๐</span>
                        <span id="cartCount" class="badge">0</span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main class="page-container max-w-md mx-auto">
        <!-- Role Selection View -->
        <div id="roleSelectionView" class="px-4 py-4 fade-in">
            <div class="text-center mt-16">
                <h1 class="text-3xl font-bold mb-2">ุฃููุงู ุจู ูู ููุฑูุชุงููุง</h1>
                <p class="text-gray-600 mb-8">ุงุฎุชุฑ ุฏูุฑู ูููุชุงุจุนุฉ</p>
                <div class="space-y-4">
                    <button id="customerBtn" class="btn btn-primary w-full">ุฒุจูู</button>
                    <button id="ownerBtn" class="btn btn-secondary w-full">ุตุงุญุจ ูุทุนู</button>
                    <button id="adminBtn" class="btn btn-secondary w-full">ูุฏูุฑ</button>
                </div>
            </div>
        </div>

        <!-- Customer View -->
        <div id="customerView" class="hidden px-4 py-4 fade-in">
            <!-- Search -->
            <div class="mb-4">
                <input
                    type="text"
                    id="searchInput"
                    placeholder="ุงุจุญุซ ุนู ุงููุทุงุนู ุฃู ุงูุฃููุงุช..."
                    class="w-full search-compact"
                >
            </div>

            <!-- Categories -->
            <div class="mb-4">
                <div class="flex gap-2 overflow-x-auto pb-2">
                    <button class="category-pill active" data-category="all">ุงููู</button>
                    <button class="category-pill" data-category="traditional">ุชูููุฏู</button>
                    <button class="category-pill" data-category="fastfood">ุณุฑูุน</button>
                    <button class="category-pill" data-category="desserts">ุญูููุงุช</button>
                    <button class="category-pill" data-category="beverages">ูุดุฑูุจุงุช</button>
                </div>
            </div>

            <!-- Restaurants -->
            <div class="mb-6">
                <h2 class="font-semibold text-lg mb-3 text-gray-800">ุงููุทุงุนู</h2>
                <div id="restaurantGrid" class="grid grid-cols-1 gap-3">
                    <!-- Restaurants will be loaded here -->
                </div>
            </div>

            <!-- Popular Dishes -->
            <div id="popularDishes">
                <h2 class="font-semibold text-lg mb-3 text-gray-800">ุงูุฃุทุจุงู ุงููููุฒุฉ</h2>
                <div class="grid grid-cols-1 gap-3">
                    <!-- Popular dishes will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Restaurant Menu View -->
        <div id="menuView" class="hidden px-4 py-4 fade-in">
            <button id="backToRestaurants" class="flex items-center gap-2 mb-4 text-secondary">
                <span>โ</span>
                <span class="text-sm">ุงูุนูุฏุฉ</span>
            </button>

            <div id="restaurantHeader" class="card-compact rounded-lg p-4 mb-4">
                <!-- Restaurant details will be loaded here -->
            </div>

            <div>
                <h3 class="font-semibold text-base mb-3">ูุงุฆูุฉ ุงูุทุนุงู</h3>
                <div id="menuItems" class="grid grid-cols-1 gap-3">
                    <!-- Menu items will be loaded here -->
                </div>
            </div>
        </div>

        <!-- Owner Panel View -->
        <div id="ownerView" class="hidden px-4 py-4 fade-in">
            <div class="flex items-center justify-between mb-4">
                <h2 class="font-semibold text-lg">ููุญุฉ ุงููุทุนู</h2>
            </div>

            <div id="ownerRestaurantStatus" class="mb-6">
                <!-- Status toggle will be rendered here -->
            </div>

            <div>
                <h3 class="font-semibold text-base mb-3">ุงูุทูุจุงุช ุงููุงุฑุฏุฉ</h3>
                <div id="ordersContainer" class="space-y-3">
                    <!-- Orders will be displayed here -->
                </div>
            </div>
        </div>

        <!-- Admin Panel View -->
        <div id="adminView" class="hidden px-4 py-4 fade-in">
            <div class="flex items-center justify-between mb-4">
                <h2 class="font-semibold text-lg">ุงูุฅุฏุงุฑุฉ</h2>
                <button id="addRestaurantBtn" class="btn btn-success text-xs">
                    + ูุทุนู
                </button>
            </div>

            <!-- Admin Tabs -->
            <div class="mb-4">
                <div class="flex bg-gray-100 rounded-lg p-1">
                    <button class="admin-tab-btn flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all" data-tab="restaurants">
                        ุงููุทุงุนู
                    </button>
                    <button class="admin-tab-btn flex-1 py-2 px-3 rounded-md text-sm font-medium transition-all" data-tab="dishes">
                        ุงูุฃุทุจุงู
                    </button>
                </div>
            </div>

            <!-- Restaurants Management -->
            <div id="adminRestaurants" class="admin-tab-content">
                <div id="restaurantsManagement" class="space-y-3">
                    <!-- Restaurant management cards will be loaded here -->
                </div>
            </div>

            <!-- Dishes Management -->
            <div id="adminDishes" class="admin-tab-content hidden">
                <div class="mb-3">
                    <select id="dishRestaurantSelect" class="input-field w-full text-sm">
                        <option value="">ุงุฎุชุฑ ูุทุนู</option>
                    </select>
                </div>
                <div id="dishesManagement" class="space-y-3">
                    <!-- Dish management cards will be loaded here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Bottom Navigation -->
    <nav class="bottom-nav">
        <div class="flex h-full">
            <div class="nav-item active" data-view="customer">
                <span class="text-lg mb-1">๐</span>
                <span class="text-xs">ุงูุฑุฆูุณูุฉ</span>
            </div>
            <div id="ownerNav" class="nav-item hidden" data-view="owner">
                <span class="text-lg mb-1">๐จโ๐ณ</span>
                <span class="text-xs">ุงููุทุนู</span>
            </div>
            <div id="adminNav" class="nav-item hidden" data-view="admin">
                <span class="text-lg mb-1">โ๏ธ</span>
                <span class="text-xs">ุงูุฅุฏุงุฑุฉ</span>
            </div>
            <div id="authNavItem" class="nav-item cursor-pointer">
                <!-- This will be dynamically filled by JS -->
            </div>
        </div>
    </nav>

    <!-- Modals -->

    <!-- Cart Modal -->
    <div id="cartModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-md">
            <div class="p-4 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="font-semibold text-base">ุณูุฉ ุงูุชุณูู</h3>
                    <button id="closeCartModal" class="text-gray-500 text-xl">&times;</button>
                </div>
            </div>

            <div id="cartItems" class="p-4 max-h-64 overflow-y-auto">
                <!-- Cart items will be displayed here -->
            </div>

            <div class="p-4 border-t bg-gray-50">
                <div class="flex items-center justify-between mb-3">
                    <span class="font-semibold text-sm">ุงูุฅุฌูุงูู:</span>
                    <span id="cartTotal" class="font-bold text-secondary">0 ุฃูููุฉ</span>
                </div>
                <button id="checkoutBtn" class="btn btn-primary w-full">
                    ุฅุชูุงู ุงูุทูุจ
                </button>
            </div>
        </div>
    </div>

    <!-- Checkout Modal -->
    <div id="checkoutModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-lg">
            <div class="p-4 border-b">
                <div class="flex items-center justify-between">
                    <h3 class="font-semibold text-base">ุชุฃููุฏ ุงูุทูุจ</h3>
                    <button id="closeCheckoutModal" class="text-gray-500 text-xl">&times;</button>
                </div>
            </div>

            <form id="checkoutForm" class="p-4 space-y-4">
                <div>
                    <label class="block text-sm font-medium mb-1">ุงูุงุณู *</label>
                    <input type="text" id="customerName" class="input-field w-full" required>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุงููุงุชู *</label>
                    <input type="tel" id="customerPhone" class="input-field w-full" required>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุงูุนููุงู *</label>
                    <textarea id="customerAddress" class="input-field w-full" rows="2" required></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุทุฑููุฉ ุงูุฏูุน *</label>
                    <select id="paymentMethod" class="input-field w-full" required>
                        <option value="">ุงุฎุชุฑ</option>
                        <option value="cash">ููุฏู</option>
                        <option value="electronic">ุฅููุชุฑููู</option>
                    </select>
                </div>

                <div id="paymentProofSection" class="hidden">
                    <label class="block text-sm font-medium mb-1">ุฅุซุจุงุช ุงูุฏูุน *</label>
                    <input type="file" id="paymentProof" class="input-field w-full" accept="image/*">
                </div>

                <div class="border-t pt-4">
                    <div class="flex items-center justify-between mb-4">
                        <span class="font-semibold">ุงููุฌููุน:</span>
                        <span id="finalTotal" class="font-bold text-secondary text-lg">0 ุฃูููุฉ</span>
                    </div>

                    <button type="submit" class="btn btn-success w-full">
                        ุชุฃููุฏ ุงูุทูุจ
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Success Modal -->
    <div id="successModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-sm text-center p-6">
            <div class="text-4xl mb-3">โ</div>
            <h3 class="font-semibold text-base mb-2">ุชู ุฅุฑุณุงู ุงูุทูุจ!</h3>
            <p class="text-sm text-gray-600 mb-4">ุณูุชู ุงูุชูุงุตู ูุนูู ูุฑูุจุงู</p>
            <button id="closeSuccessModal" class="btn btn-primary">
                ุญุณูุงู
            </button>
        </div>
    </div>

    <!-- Restaurant Form Modal -->
    <div id="restaurantFormModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-4 border-b">
                <div class="flex items-center justify-between">
                    <h3 id="restaurantModalTitle" class="font-semibold text-base">ุฅุถุงูุฉ ูุทุนู</h3>
                    <button id="closeRestaurantModal" class="text-gray-500 text-xl">&times;</button>
                </div>
            </div>

            <form id="restaurantForm" class="p-4 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">ุตูุฑุฉ ุงููุทุนู</label>
                        <div class="file-upload-area" onclick="document.getElementById('restaurantImageInput').click()">
                            <input type="file" id="restaurantImageInput" accept="image/*">
                            <div id="restaurantImagePreview" class="flex flex-col items-center justify-center py-4">
                                <span class="text-2xl mb-2">๐ท</span>
                                <span class="text-xs text-gray-500">ุงููุฑ ูุงุฎุชูุงุฑ ุตูุฑุฉ</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">ุงุณู ุงููุทุนู *</label>
                            <input type="text" id="restaurantName" class="input-field w-full" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-1">ุงูุฑูุฒ ุงูุชุนุจูุฑู</label>
                            <input type="text" id="restaurantLogo" class="input-field w-full" maxlength="2">
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-1">ุงูุชูููู *</label>
                            <input type="number" id="restaurantRating" class="input-field w-full" min="1" max="5" step="0.1" required>
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุงููุตู *</label>
                    <textarea id="restaurantDescription" class="input-field w-full" rows="2" required></textarea>
                </div>

                <div class="grid grid-cols-1 md:grid-cols-3 gap-3">
                    <div>
                        <label class="block text-sm font-medium mb-1">ููุช ุงูุชูุตูู *</label>
                        <input type="text" id="restaurantDeliveryTime" class="input-field w-full" required>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-1">ุงูุชุตููู *</label>
                        <select id="restaurantCategory" class="input-field w-full" required>
                            <option value="">ุงุฎุชุฑ</option>
                            <option value="traditional">ุชูููุฏู</option>
                            <option value="fastfood">ุณุฑูุน</option>
                            <option value="desserts">ุญูููุงุช</option>
                            <option value="beverages">ูุดุฑูุจุงุช</option>
                        </select>
                    </div>

                    <div>
                        <label class="block text-sm font-medium mb-1">ููู ุงูุฎูููุฉ *</label>
                        <input type="color" id="restaurantBgColor" class="input-field w-full h-10" required>
                    </div>
                </div>

                <div class="flex gap-3">
                    <button type="submit" class="btn btn-success flex-1">ุญูุธ</button>
                    <button type="button" id="cancelRestaurantForm" class="btn btn-secondary flex-1">ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Dish Form Modal -->
    <div id="dishFormModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-2xl">
            <div class="p-4 border-b">
                <div class="flex items-center justify-between">
                    <h3 id="dishModalTitle" class="font-semibold text-base">ุฅุถุงูุฉ ุทุจู</h3>
                    <button id="closeDishModal" class="text-gray-500 text-xl">&times;</button>
                </div>
            </div>

            <form id="dishForm" class="p-4 space-y-4">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-1">ุตูุฑุฉ ุงูุทุจู</label>
                        <div class="file-upload-area" onclick="document.getElementById('dishImageInput').click()">
                            <input type="file" id="dishImageInput" accept="image/*">
                            <div id="dishImagePreview" class="flex flex-col items-center justify-center py-4">
                                <span class="text-2xl mb-2">๐ท</span>
                                <span class="text-xs text-gray-500">ุงููุฑ ูุงุฎุชูุงุฑ ุตูุฑุฉ</span>
                            </div>
                        </div>
                    </div>

                    <div class="space-y-3">
                        <div>
                            <label class="block text-sm font-medium mb-1">ุงุณู ุงูุทุจู *</label>
                            <input type="text" id="dishName" class="input-field w-full" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-1">ุงูุณุนุฑ (ุฃูููุฉ) *</label>
                            <input type="number" id="dishPrice" class="input-field w-full" min="1" required>
                        </div>

                        <div>
                            <label class="block text-sm font-medium mb-1">ุงูุฑูุฒ ุงูุชุนุจูุฑู</label>
                            <input type="text" id="dishImage" class="input-field w-full" maxlength="2">
                        </div>
                    </div>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุงููุตู *</label>
                    <textarea id="dishDescription" class="input-field w-full" rows="2" required></textarea>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1">ุงูุชุตููู *</label>
                    <select id="dishCategory" class="input-field w-full" required>
                        <option value="">ุงุฎุชุฑ</option>
                        <option value="traditional">ุชูููุฏู</option>
                        <option value="fastfood">ุณุฑูุน</option>
                        <option value="desserts">ุญูููุงุช</option>
                        <option value="beverages">ูุดุฑูุจุงุช</option>
                    </select>
                </div>

                <div class="flex gap-3">
                    <button type="submit" class="btn btn-success flex-1">ุญูุธ</button>
                    <button type="button" id="cancelDishForm" class="btn btn-secondary flex-1">ุฅูุบุงุก</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Sign In View -->
    <div id="signInView" class="hidden px-4 py-4 fade-in">
        <div class="max-w-md mx-auto mt-8">
            <h2 class="text-2xl font-bold text-center mb-6">ุชุณุฌูู ุงูุฏุฎูู</h2>
            <form id="loginForm" class="space-y-4">
                <div>
                    <label for="loginEmail" class="block text-sm font-medium mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="loginEmail" class="input-field w-full" required>
                </div>
                <div>
                    <label for="loginPassword" class="block text-sm font-medium mb-1">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="loginPassword" class="input-field w-full" required>
                </div>
                <div id="loginError" class="text-danger text-sm hidden"></div>
                <div class="pt-2">
                    <button type="submit" class="btn btn-primary w-full">
                        ุฏุฎูู
                    </button>
                </div>
            </form>
            <p class="text-center text-sm mt-4">
                ููุณ ูุฏูู ุญุณุงุจุ <a href="#" id="showSignUpLink" class="text-primary hover:underline">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</a>
            </p>
        </div>
    </div>

    <!-- Sign Up View -->
    <div id="signUpView" class="hidden px-4 py-4 fade-in">
        <div class="max-w-md mx-auto mt-8">
            <h2 class="text-2xl font-bold text-center mb-6">ุฅูุดุงุก ุญุณุงุจ ุฌุฏูุฏ</h2>
            <form id="signUpForm" class="space-y-4">
                <div>
                    <label for="signUpEmail" class="block text-sm font-medium mb-1">ุงูุจุฑูุฏ ุงูุฅููุชุฑููู</label>
                    <input type="email" id="signUpEmail" class="input-field w-full" required>
                </div>
                <div>
                    <label for="signUpPassword" class="block text-sm font-medium mb-1">ูููุฉ ุงููุฑูุฑ</label>
                    <input type="password" id="signUpPassword" class="input-field w-full" required>
                </div>
                <div id="signUpError" class="text-danger text-sm hidden"></div>
                <div class="pt-2">
                    <button type="submit" class="btn btn-primary w-full">
                        ุฅูุดุงุก ุญุณุงุจ
                    </button>
                </div>
            </form>
            <p class="text-center text-sm mt-4">
                ูุฏูู ุญุณุงุจ ุจุงููุนูุ <a href="#" id="showSignInLink" class="text-primary hover:underline">ุชุณุฌูู ุงูุฏุฎูู</a>
            </p>
        </div>
    </div>

    <!-- Confirm Delete Modal -->
    <div id="confirmDeleteModal" class="modal-overlay hidden items-center justify-center p-4">
        <div class="modal-content w-full max-w-sm text-center p-6">
            <div class="text-3xl mb-3">โ๏ธ</div>
            <h3 class="font-semibold text-base mb-2">ุชุฃููุฏ ุงูุญุฐู</h3>
            <p id="deleteMessage" class="text-sm text-gray-600 mb-4">ูู ุฃูุช ูุชุฃูุฏุ</p>
            <div class="flex gap-3">
                <button id="confirmDelete" class="btn btn-danger flex-1">ุญุฐู</button>
                <button id="cancelDelete" class="btn btn-secondary flex-1">ุฅูุบุงุก</button>
            </div>
        </div>
    </div>

    <script src="app.js"></script>
</body>
</html>
